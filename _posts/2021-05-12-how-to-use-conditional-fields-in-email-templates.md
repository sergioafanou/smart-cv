---
title : "How to Use Conditional Fields in Email Templates"
layout: post
categories: [  ]
tags: tutorial labnol
post_inspiration: https://www.labnol.org/conditional-email-merge-fields-200626
image: "https://sergio.afanou.com/assets/images/image-midres-52.jpg"
---

<p>The <a href="https://gsuite.google.com/marketplace/app/mail_merge_with_attachments/223404411203" target="_blank" rel="nofollow noopener noreferrer">Mail Merge</a> and <a href="https://gsuite.google.com/marketplace/app/document_studio/429444628321" target="_blank" rel="nofollow noopener noreferrer">Document Studio</a> add-ons let you send personalized emails with the help of template markers.</p><p>The markers automatically create a mapping between the column names in the Google Sheet and the variable fields in your email message. When the email is sent, the marker fields in the email message are replaced with the values from the respective columns of the sheet.</p><p>Let’s say you have a column titled <code class="language-text">First Name</code> in your Google Sheet and your email message body has a marker that says <code class="language-text">Dear {{First Name}},</code> (also notice the comma in the end).</p><p><span class="gatsby-resp-image-wrapper" style="display:block;margin-left:auto;margin-right:auto;max-width:676px;">
      <a class="gatsby-resp-image-link" href="/static/defdd716768425dd4f0fe1159c2a6729/080e7/182420.png" style="display:block;" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="display:block;"></span>
  <img class="gatsby-resp-image-image" alt="Template Fields in Mail Merge" title="Template Fields in Mail Merge" src="/static/defdd716768425dd4f0fe1159c2a6729/080e7/182420.png" style="width:100%;height:100%;margin:0;vertical-align:middle;">
  </a>
    </span></p><h3 id="fill-in-fields">
<a href="#fill-in-fields" class="anchor before"><svg height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fill-in Fields</h3><p>If your Google Sheet rows has a value, say Alex, the text in the email message would read <code class="language-text">Dear Alex,</code>. However, if the first name is not available for a particular row, the variable field would be replaced with a blank value and this first line in the email message would thus read <code class="language-text">Dear &lt;space&gt;,</code> - something that you should totally avoid in personalized emails.</p><p>There are two ways to deal with this issue. You can either clean up your data before running merge, or you can use formulas in Google Sheets to offer an alternate value in case the original field doesn’t have a value. Let me explain:</p><ol>
<li><p>Add a new column in the Google Sheet title “Greeting”</p></li>
<li><p>Add a formula in row #2 of the Greeting column.</p></li>
</ol><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">=IF(ISBLANK(A2),"Hello",CONCATENATE("Dear", " ", A2))</code></pre></div><p>The formula basically looks at the Name column, it is blank, the greeting is set to “Hello” else it uses the default “Hello FirstName” value.</p><ol start="3"><li>Now edit your email template and replace “Dear {{Name}},” with “{{Greeting}},“.</li></ol><p>You can either copy-paste the formula in the remaining cells of the column manually or use the <a href="/internet/arrayformula-copy-formulas-in-entire-column/29711/">ArrayFormula function</a> to copy it down for you.</p><h3 id="ifthenelse">
<a href="#ifthenelse" class="anchor before"><svg height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>If..Then..Else</h3><p>The technique can be extended to add more customization to your email message. For instance, you may choose a different greeting in your email subject based on the country of the recipient.</p><p><span class="gatsby-resp-image-wrapper" style="display:block;margin-left:auto;margin-right:auto;max-width:720px;">
      <a class="gatsby-resp-image-link" href="/static/f733b4321cb80c0e463a66020bb9639f/89c55/184745.png" style="display:block;" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="display:block;"></span>
  <img class="gatsby-resp-image-image" alt="Email Greetings" title="Email Greetings" src="/static/f733b4321cb80c0e463a66020bb9639f/16546/184745.png" style="width:100%;height:100%;margin:0;vertical-align:middle;">
  </a>
    </span></p><p>If the country is in column B, the Greeting formula would be:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">=IFNA(
  IFS(
   B2 = "USA", "Hello",
   B2 = "Spain", "Hola",
   B2 = "India", "Namaste"
  ), "Greetings")</code></pre></div><h3 id="calculated-fields">
<a href="#calculated-fields" class="anchor before"><svg height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Calculated Fields</h3><p>The templates fields in the email message are dumb and merely get replaced by values in the Google Sheet. If you wish to include any logic or calculations in the template fields, it should be done in the sheet itself.</p><p>Let me give you another example.</p><p><span class="gatsby-resp-image-wrapper" style="display:block;margin-left:auto;margin-right:auto;max-width:720px;">
      <a class="gatsby-resp-image-link" href="/static/c98ee517ec5f023d370aed1342d008eb/b6e86/194500.png" style="display:block;" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="display:block;"></span>
  <img class="gatsby-resp-image-image" alt="Conditional Fields in Mail Merge" title="Conditional Fields in Mail Merge" src="/static/c98ee517ec5f023d370aed1342d008eb/16546/194500.png" style="width:100%;height:100%;margin:0;vertical-align:middle;">
  </a>
    </span></p><p>The Google Sheet records the invoice details and <a href="/send-reminder-emails-200425">sends email reminders</a> for payments. Using the magic of Google Sheet formulas and template markers, the text of the email message can be dynamically changed based on when the invoice is due. If the due date has already passed, we send a different message.</p><p>First add a new column (say, Days Left) that calculates the number days between now and the invoice due date. Add this formula in row #2 of the column. It will only fill values when the due date is available.</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">=ArrayFormula(IF(ISBLANK(C2:C),"", ROUND(C2:C-TODAY())))</code></pre></div><p>Add a new “Invoice Status” column and again use the <a href="/internet/arrayformula-copy-formulas-in-entire-column/29711/">ArrayFormula function</a> to get the text for the email message body and subject.</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">=ArrayFormula(
  IF(ISBLANK(C2:C), "" ,
     IF(D2:D&gt;0, CONCAT("due on ",TEXT(C2:C,"mmmm dd, yyyy")),
                CONCAT(ABS(D2:D)," days past due"))))</code></pre></div><p>See more <a href="/topic/google-sheets/">Google Sheets solutions</a>.</p>